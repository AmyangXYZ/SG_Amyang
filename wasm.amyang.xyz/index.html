<html>
	<head>
		<meta charset="utf-8">
		<script src="wasm_exec.js"></script>
		<script>
			const go = new Go();
			WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject).then((result) => {
				go.run(result.instance);
			});
		</script>
	</head>
	<body>
    <h1>Sleep Sort in WebAssembly</h1>
    <p id="raw nums">Raw nums: </p>
    <p id="sorted nums">Sorted nums: </p>
    <br>
<pre><code class="lang-go">func sleepSort(nums []int) {
    blockers := make(chan struct{}, len(nums))
    for _, n := range nums {
        blockers &lt;- struct{}{}
        go func(n int, blocker chan struct{}) {
            defer func() { &lt;-blocker }()
            time.Sleep(time.Duration(n) * 25 * time.Millisecond)
            out &lt;- n
        }(n, blockers)
    }

    for i := 0; i &lt; cap(blockers); i++ {
        blockers &lt;- struct{}{}
    }
    close(out)
}
</code></pre>
    </body>
</html>
